import bmi.wrapper

# NOTE! LD_LIBRARY_PATH must be set BEFORE PYTHON STARTS
# ctypes relies on the dynamic linker which reads LD_LIBRARY_PATH
# during process initializiation, so mucking with os.environ
# is a day late and a dollar short.

# NOTE B: this will not play well with online DWAQ. Not sure how
# to specify the process file, and without that the model bails.

wrapper = bmi.wrapper.BMIWrapper(engine='dflowfm',
                                 configfile='/home/rusty/src/pescadero/model/model/run_rectangle/flowfm.mdu')
wrapper.initialize()

##

var_count=wrapper.get_var_count()  # 176

for vi in range(var_count):
    print(f"{vi:4d}: {wrapper.get_var_name(vi)}")

##

#    0: b'DFM_COMM_DFMWORLD'
#    1: b'iglobal_s'
#    2: b'hwav'
#    3: b'twav'
#    4: b'Uorb'
#    5: b'bodsed'
#    6: b'dpsed'
#    7: b'msed'
#    8: b'thlyr'
#    9: b'rsedeq'
#   10: b'sbcx'
#   11: b'sbcy'
#   12: b'sbwx'
#   13: b'sbwy'
#   14: b'sscx'
#   15: b'sscy'
#   16: b'sswx'
#   17: b'sswy'
#   18: b'taucr'
#   19: b'tetacr'
#   20: b'infilt'
#   21: b'infiltcap'
#   22: b'shx'
#   23: b'shy'
#   24: b'shi'
#   25: b'zsp'
#   26: b'zsp0'
#   27: b'zspc'
#   28: b'zspc0'
#   29: b'v0ship'
#   30: b'v1ship'
#   31: b'qinship'
#   32: b'vicushp'
#   33: b'shL'
#   34: b'shB'
#   35: b'shd'
#   36: b'stuw'
#   37: b'fstuw'
#   38: b'stuwmx'
#   39: b'roer'
#   40: b'froer'
#   41: b'roermx'
#   42: b'wx'
#   43: b'wy'
#   44: b'rain'
#   45: b'evap'
#   46: b'numlatsg'
#   47: b'qplat'
#   48: b'qqlat'
#   49: b'balat'
#   50: b'n1latsg'
#   51: b'n2latsg'
#   52: b'nnlat'
#   53: b'kclat'
#   54: b'qext'
#   55: b'qextreal'
#   56: b'vextcum'
#   57: b'rainuni'
#   58: b'Qsunmap'
#   59: b'zbndz'
#   60: b'zbndu'
#   61: b'zbndq'
#   62: b'turkin1'
#   63: b'vicwws'
#   64: b'rnveg'
#   65: b'diaveg'
#   66: b'cfuveg'
#   67: b'alfaveg'
#   68: b'stemdens'
#   69: b'stemdiam'
#   70: b'stemheight'
#   71: b'Cdvegsp'
#   72: b'zws'
#   73: b'kbot'
#   74: b'ktop'
#   75: b'Lbot'
#   76: b'Ltop'
#   77: b's0'
#   78: b's1'
#   79: b'a0'
#   80: b'a1'
#   81: b'vol0'
#   82: b'vol1'
#   83: b'vol1_f'
#   84: b'hs'
#   85: b'ucx'
#   86: b'ucy'
#   87: b'ucz'
#   88: b'ucmag'
#   89: b'sa0'
#   90: b'sa1'
#   91: b'satop'
#   92: b'sabot'
#   93: b'tem0'
#   94: b'tem1'
#   95: b'u1'
#   96: b'u_to_umain'
#   97: b'q1'
#   98: b'q1_main'
#   99: b'au'
#  100: b'hu'
#  101: b'frcu'
#  102: b'viusp'
#  103: b'diusp'
#  104: b'taus'
#  105: b'ndxi'
#  106: b'ndx1db'
#  107: b'kfs'
#  108: b'bare'
#  109: b'ba_mor'
#  110: b'bl'
#  111: b'lnx1D'
#  112: b'lnxi'
#  113: b'lnx1Db'
#  114: b'lnx'
#  115: b'ln'
#  116: b'LLkkk'
#  117: b'lncn'
#  118: b'iadv'
#  119: b'dx'
#  120: b'wu'
#  121: b'wu_mor'
#  122: b'wu1D2D'
#  123: b'hh1D2D'
#  124: b'bob'
#  125: b'bob0'
#  126: b'xu'
#  127: b'yu'
#  128: b'vort'
#  129: b'xzw'
#  130: b'yzw'
#  131: b'xk'
#  132: b'yk'
#  133: b'zk'
#  134: b'kn'
#  135: b'numk'
#  136: b'zbnd1d2d1'
#  137: b'zbnd1d2d0'
#  138: b'zcrest1d2d'
#  139: b'edgenumbers1d2d'
#  140: b'kbnd1d2d'
#  141: b'width_1d'
#  142: b'qzeta_1d2d'
#  143: b'qlat_1d2d'
#  144: b'qtotal_1d2d'
#  145: b'is_sumvalsnd'
#  146: b'is_maxvalsnd'
#  147: b'is_dtint'
#  148: b'ndx2d'
#  149: b'ndx'
#  150: b'xz'
#  151: b'yz'
#  152: b'ba'
#  153: b'pumps'
#  154: b'weirs'
#  155: b'orifices'
#  156: b'gates'
#  157: b'generalstructures'
#  158: b'culverts'
#  159: b'sourcesinks'
#  160: b'dambreak'
#  161: b'observations'
#  162: b'crosssections'
#  163: b'laterals'
#  164: b'uabs'
#  165: b'sed1'
#  166: b'netelemnode'
#  167: b'flowelemnode'
#  168: b'flowelemnbs'
#  169: b'flowelemlns'
#  170: b'flowelemcontour_x'
#  171: b'flowelemcontour_y'
#  172: b'kn'
#  173: b'TcrEro'
#  174: b'TcrSed'
#  175: b'tem1Surf'

##

# What would happen if I updated bl?
# 

    
##
wrapper.stop()
